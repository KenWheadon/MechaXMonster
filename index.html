<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mecha X Monster</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="game-container">
      <!-- Start Screen -->
      <div id="start-screen" class="screen active">
        <h1>🤖 MECHA X MONSTER 🤖</h1>
        <p class="tagline">Can You Stop the Evil Slime?</p>
        <p>
          Welcome to the asteroid mining colony! The evil slimes have taken over
          our mining operations. Build powerful mechas from mined parts and
          fight back!
        </p>
        <button
          class="btn btn-large"
          onclick="typeof startGame === 'function' ? startGame() : console.log('Game not ready yet')"
        >
          Start Mining
        </button>
      </div>

      <!-- Mine Selection Screen -->
      <div id="mine-selection-screen" class="screen">
        <h1>🌌 Asteroid Mining Colony 🌌</h1>
        <p>
          Select a mining location to begin operations. Each mine produces
          different resources and houses unique mechas!
        </p>

        <div class="mine-map">
          <div class="mine-location" id="mine-1" onclick="selectMine(1)">
            <div class="mine-name">🪨 Rock Mine</div>
            <div class="mine-cost">FREE - Start Here!</div>
            <div class="mine-preview">
              <div class="mecha-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%2327ae60' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
                  alt="Green Mecha"
                />
                <div>Green Mecha</div>
              </div>
              <div style="font-size: 24px">VS</div>
              <div class="monster-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%23f1c40f'/><circle cx='40' cy='50' r='4' fill='%23000'/><circle cx='60' cy='50' r='4' fill='%23000'/></svg>"
                  alt="Yellow Slime"
                />
                <div>Yellow Slime</div>
              </div>
            </div>
            <div>Produces: 🐚 Shells</div>
          </div>

          <div class="mine-location locked" id="mine-2">
            <div class="mine-name">❄️ Ice Mine</div>
            <div class="mine-cost">Cost: 20 Monster Shells</div>
            <div class="mine-preview">
              <div class="mecha-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%23f1c40f' rx='10'/><circle cx='40' cy='40' r='5' fill='%23000'/><circle cx='60' cy='40' r='5' fill='%23000'/></svg>"
                  alt="Yellow Mecha"
                />
                <div>Yellow Mecha</div>
              </div>
              <div style="font-size: 24px">VS</div>
              <div class="monster-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%2317a2b8'/><circle cx='40' cy='50' r='4' fill='%23fff'/><circle cx='60' cy='50' r='4' fill='%23fff'/></svg>"
                  alt="Teal Slime"
                />
                <div>Teal Slime</div>
              </div>
            </div>
            <div>Produces: 🪙 Coins</div>
          </div>

          <div class="mine-location locked" id="mine-3">
            <div class="mine-name">🔥 Lava Mine</div>
            <div class="mine-cost">Cost: 100 Monster Coins</div>
            <div class="mine-preview">
              <div class="mecha-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%23e74c3c' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
                  alt="Red Mecha"
                />
                <div>Red Mecha</div>
              </div>
              <div style="font-size: 24px">VS</div>
              <div class="monster-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%233498db'/><circle cx='40' cy='50' r='4' fill='%23fff'/><circle cx='60' cy='50' r='4' fill='%23fff'/></svg>"
                  alt="Blue Slime"
                />
                <div>Blue Slime</div>
              </div>
            </div>
            <div>Produces: 🥇 Bars</div>
          </div>

          <div class="mine-location locked" id="mine-4">
            <div class="mine-name">💎 Crystal Mine</div>
            <div class="mine-cost">Cost: 500 Monster Bars</div>
            <div class="mine-preview">
              <div class="mecha-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%233498db' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
                  alt="Blue Mecha"
                />
                <div>Blue Mecha</div>
              </div>
              <div style="font-size: 24px">VS</div>
              <div class="monster-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%23e67e22'/><circle cx='40' cy='50' r='4' fill='%23000'/><circle cx='60' cy='50' r='4' fill='%23000'/></svg>"
                  alt="Orange Slime"
                />
                <div>Orange Slime</div>
              </div>
            </div>
            <div>Produces: 📜 Bonds</div>
          </div>

          <div class="mine-location locked" id="mine-5">
            <div class="mine-name">🌟 Plasma Mine</div>
            <div class="mine-cost">Cost: 2000 Monster Bonds</div>
            <div class="mine-preview">
              <div class="mecha-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%23e91e63' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
                  alt="Pink Mecha"
                />
                <div>Pink Mecha</div>
              </div>
              <div style="font-size: 24px">VS</div>
              <div class="monster-preview">
                <img
                  src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%23000'/><circle cx='40' cy='50' r='4' fill='%23fff'/><circle cx='60' cy='50' r='4' fill='%23fff'/></svg>"
                  alt="Black Slime"
                />
                <div>Black Slime</div>
              </div>
            </div>
            <div>Produces: 💎 Gems</div>
          </div>
        </div>

        <div class="trading-post">
          <h3>🤖 AstroGuide Trading Post</h3>
          <p>
            Need to exchange currencies? I can help, but my rates aren't great!
          </p>
          <div class="exchange-rates" id="exchange-rates">
            <!-- Dynamic exchange options will be populated here -->
          </div>
        </div>
      </div>

      <!-- Mining Screen -->
      <div id="mining-screen" class="screen">
        <h2 id="mine-title">🪨 Rock Mine Operations</h2>

        <div class="mining-interface">
          <div class="mining-area">
            <h3>Mining Operations</h3>

            <!-- Main Mining Machine -->
            <div
              class="mining-machine"
              id="main-mining-machine"
              onclick="interactMiningMachine()"
            >
              <div class="machine-status">
                <h4>Primary Excavator</h4>
                <div class="progress-bar">
                  <div class="progress-fill" id="mining-progress"></div>
                </div>
                <div class="currency-display">
                  <span>Ready to Collect:</span>
                  <span class="currency-amount" id="pending-currency"
                    >0 🐚</span
                  >
                </div>
                <div class="currency-display">
                  <span>Geodes Ready:</span>
                  <span class="currency-amount" id="pending-geodes">0 📦</span>
                </div>
                <button
                  class="btn"
                  id="collect-btn"
                  onclick="collectResources()"
                  disabled
                >
                  Collect Resources
                </button>
              </div>
            </div>

            <!-- Additional Mining Machines -->
            <div class="mining-machine locked" id="mining-machine-2">
              <div class="machine-status">
                <h4>Secondary Excavator</h4>
                <div class="mine-cost">Cost: 25 🐚 + 0 Monster Shells</div>
                <button class="btn" onclick="buyMiningMachine(2)">
                  Purchase Machine
                </button>
              </div>
            </div>

            <div class="mining-machine locked" id="mining-machine-3">
              <div class="machine-status">
                <h4>Advanced Excavator</h4>
                <div class="mine-cost">Cost: 50 🐚 + 1 Monster Shell</div>
                <button class="btn" onclick="buyMiningMachine(3)">
                  Purchase Machine
                </button>
              </div>
            </div>

            <div class="mining-machine locked" id="mining-machine-4">
              <div class="machine-status">
                <h4>Quantum Excavator</h4>
                <div class="mine-cost">Cost: 500 🐚 + 10 Monster Shells</div>
                <button class="btn" onclick="buyMiningMachine(4)">
                  Purchase Machine
                </button>
              </div>
            </div>

            <!-- Currency Display -->
            <div class="currency-display">
              <span>Total 🐚 Shells:</span>
              <span class="currency-amount" id="total-currency">0</span>
            </div>
            <div class="currency-display">
              <span>Monster Shells:</span>
              <span class="currency-amount" id="monster-currency">0</span>
            </div>

            <!-- Upgrades -->
            <button class="btn" onclick="openUpgrades()">
              🎰 Spin for Upgrades
            </button>
          </div>

          <div class="mecha-building">
            <h3>Mecha Assembly</h3>

            <div class="mecha-display">
              <img
                src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%2327ae60' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
                alt="Green Mecha"
                class="mecha-image"
                id="mecha-image"
              />
              <div id="mecha-multiplier">Production Bonus: x1</div>
            </div>

            <div class="parts-grid">
              <div class="part-slot" id="part-head">
                <span>🤖</span>
                <div class="part-name">Head</div>
              </div>
              <div class="part-slot" id="part-left-arm">
                <span>💪</span>
                <div class="part-name">Left Arm</div>
              </div>
              <div class="part-slot" id="part-right-arm">
                <span>💪</span>
                <div class="part-name">Right Arm</div>
              </div>
              <div class="part-slot" id="part-torso">
                <span>🛡️</span>
                <div class="part-name">Torso</div>
              </div>
              <div class="part-slot" id="part-left-leg">
                <span>🦵</span>
                <div class="part-name">Left Leg</div>
              </div>
              <div class="part-slot" id="part-right-leg">
                <span>🦵</span>
                <div class="part-name">Right Leg</div>
              </div>
            </div>

            <button
              class="btn build-mecha-btn"
              id="build-mecha-btn"
              onclick="buildMecha()"
              disabled
            >
              Build Mecha (Need All Parts)
            </button>

            <div class="combat-ready" id="combat-ready" style="display: none">
              <h4>🚨 Combat Ready! 🚨</h4>
              <div class="monster-info">
                <div>
                  <img
                    src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%23f1c40f'/><circle cx='40' cy='50' r='4' fill='%23000'/><circle cx='60' cy='50' r='4' fill='%23000'/></svg>"
                    alt="Yellow Slime"
                    class="monster-image"
                  />
                  <div>Yellow Slime</div>
                  <div>Threat Level: Low</div>
                </div>
                <button class="btn" onclick="startCombat()">
                  ⚔️ Fight Monster
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="game-log" id="mining-log">
          <div class="log-entry">
            🤖 AstroGuide: Welcome to the Rock Mine! Click the mining machine to
            start operations.
          </div>
          <div class="log-entry">
            🤖 AstroGuide: Collect resources and build mecha parts to defend our
            colony!
          </div>
        </div>

        <button class="btn" onclick="returnToMineSelection()">
          ← Back to Mine Selection
        </button>
      </div>

      <!-- Combat Screen -->
      <div id="combat-screen" class="screen">
        <h2>⚔️ Mecha Combat</h2>

        <div class="battle-arena">
          <div class="fighter-card">
            <h3 id="mecha-name">Green Mecha</h3>
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='25' y='25' width='50' height='50' fill='%2327ae60' rx='10'/><circle cx='40' cy='40' r='5' fill='%23fff'/><circle cx='60' cy='40' r='5' fill='%23fff'/></svg>"
              alt="Mecha"
              class="fighter-sprite"
              id="mecha-sprite"
            />
            <div class="stats">
              <div>
                HP: <span id="mecha-hp">100</span> /
                <span id="mecha-max-hp">100</span>
              </div>
              <div class="stat-bar">
                <div
                  class="stat-fill hp-fill"
                  id="mecha-hp-bar"
                  style="width: 100%"
                ></div>
              </div>
              <div>
                Energy: <span id="mecha-energy">12</span> /
                <span id="mecha-max-energy">12</span>
              </div>
              <div class="stat-bar">
                <div
                  class="stat-fill energy-fill"
                  id="mecha-energy-bar"
                  style="width: 100%"
                ></div>
              </div>
            </div>
          </div>

          <div class="fighter-card">
            <h3 id="monster-name">Yellow Slime</h3>
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='60' rx='35' ry='25' fill='%23f1c40f'/><circle cx='40' cy='50' r='4' fill='%23000'/><circle cx='60' cy='50' r='4' fill='%23000'/></svg>"
              alt="Monster"
              class="fighter-sprite"
              id="monster-sprite"
            />
            <div class="stats">
              <div>
                HP: <span id="monster-hp">80</span> /
                <span id="monster-max-hp">80</span>
              </div>
              <div class="stat-bar">
                <div
                  class="stat-fill hp-fill"
                  id="monster-hp-bar"
                  style="width: 100%"
                ></div>
              </div>
              <div>
                Energy: <span id="monster-energy">10</span> /
                <span id="monster-max-energy">10</span>
              </div>
              <div class="stat-bar">
                <div
                  class="stat-fill energy-fill"
                  id="monster-energy-bar"
                  style="width: 100%"
                ></div>
              </div>
            </div>
          </div>
        </div>

        <div class="move-buttons">
          <button
            class="move-btn"
            id="light-attack-btn"
            onclick="mechaMove('light')"
          >
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50 10 L60 40 L90 40 L70 60 L80 90 L50 70 L20 90 L30 60 L10 40 L40 40 Z' fill='%23f1c40f'/></svg>"
              alt="Light Attack"
              class="move-icon"
            />
            <span>Light Attack</span>
            <small>Cost: 2 Energy</small>
          </button>
          <button
            class="move-btn"
            id="heavy-attack-btn"
            onclick="mechaMove('heavy')"
          >
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%23e74c3c'/><circle cx='50' cy='50' r='20' fill='%23fff'/></svg>"
              alt="Heavy Attack"
              class="move-icon"
            />
            <span>Heavy Attack</span>
            <small>Cost: 4 Energy</small>
          </button>
          <button
            class="move-btn"
            id="defend-btn"
            onclick="mechaMove('defend')"
          >
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50 10 L80 30 L80 70 L50 90 L20 70 L20 30 Z' fill='%233498db'/></svg>"
              alt="Defend"
              class="move-icon"
            />
            <span>Defend</span>
            <small>Cost: 1 Energy</small>
          </button>
          <button class="move-btn" id="rest-btn" onclick="mechaMove('rest')">
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='%2327ae60'/><path d='M30 50 L50 30 L70 50 L50 70 Z' fill='%23fff'/></svg>"
              alt="Rest"
              class="move-icon"
            />
            <span>Rest</span>
            <small>Cost: 0 Energy</small>
          </button>
        </div>

        <div class="game-log" id="combat-log">
          <div class="log-entry combat">
            ⚔️ Combat begins! Your Green Mecha faces the Yellow Slime!
          </div>
        </div>

        <button class="btn" onclick="returnToMining()">
          ← Return to Mining
        </button>
      </div>

      <!-- Training Screen -->
      <div id="training-screen" class="screen">
        <h2>🎯 Mecha Training</h2>
        <p>Click the bubbles quickly to earn training currency!</p>

        <div class="training-area">
          <div style="text-align: center; margin-bottom: 20px">
            <div>
              Time: <span id="training-time">15</span>s | Score:
              <span id="training-score">0</span> | Combo:
              <span id="training-combo">0</span>
            </div>
          </div>

          <div class="bubble-clicker" id="bubble-area">
            <!-- Bubbles will be spawned here dynamically -->
          </div>

          <div id="training-complete" style="display: none">
            <h3>Training Complete!</h3>
            <p>Final Score: <span id="final-training-score">0</span></p>

            <div class="slots-container">
              <h4>🎰 Training Upgrades</h4>
              <p>
                Spend training currency on upgrades or try your luck with slots!
              </p>

              <div class="slots-reels">
                <div class="slot-reel" id="slot-1">❓</div>
                <div class="slot-reel" id="slot-2">❓</div>
                <div class="slot-reel" id="slot-3">❓</div>
              </div>

              <button class="btn" onclick="spinTrainingSlots()">
                🎰 Spin Slots (Cost: <span id="slot-cost">10</span>)
              </button>
              <div
                id="slot-result"
                style="margin: 10px 0; font-weight: bold"
              ></div>
            </div>

            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin: 20px 0;
              "
            >
              <button class="btn" onclick="buyTrainingUpgrade('attack')">
                +5 Attack (Cost: <span id="attack-cost">50</span>)
              </button>
              <button class="btn" onclick="buyTrainingUpgrade('defense')">
                +5 Defense (Cost: <span id="defense-cost">50</span>)
              </button>
              <button class="btn" onclick="buyTrainingUpgrade('hp')">
                +25 HP (Cost: <span id="hp-cost">75</span>)
              </button>
              <button class="btn" onclick="buyTrainingUpgrade('energy')">
                +2 Energy (Cost: <span id="energy-cost">40</span>)
              </button>
            </div>

            <button class="btn" onclick="continueAfterTraining()">
              Continue to Next Battle
            </button>
          </div>
        </div>
      </div>

      <!-- Upgrades Screen -->
      <div id="upgrades-screen" class="screen">
        <h2>🎰 Mine Upgrades</h2>
        <p>Spin the wheel to get random upgrades for your mining operation!</p>

        <div class="slots-container">
          <div class="slots-reels">
            <div class="slot-reel" id="upgrade-slot-1">❓</div>
            <div class="slot-reel" id="upgrade-slot-2">❓</div>
            <div class="slot-reel" id="upgrade-slot-3">❓</div>
          </div>

          <button class="btn" onclick="spinUpgradeSlots()">
            🎰 Spin for Upgrade (Cost: <span id="upgrade-cost">25</span> 🐚)
          </button>
          <div
            id="upgrade-result"
            style="margin: 20px 0; font-weight: bold"
          ></div>
        </div>

        <div class="game-log" id="upgrades-log">
          <div class="log-entry">
            🎰 Try your luck! Each upgrade increases the cost of the next spin.
          </div>
        </div>

        <button class="btn" onclick="returnToMining()">← Back to Mining</button>
      </div>

      <!-- Final Boss Screen -->
      <div id="final-boss-screen" class="screen">
        <h1>🏆 FINAL CHALLENGE 🏆</h1>
        <p>
          You've defeated all the mine bosses! Now face the ultimate enemy - the
          Slime King!
        </p>

        <div class="battle-arena">
          <div class="fighter-card">
            <h3>Ultimate Mecha</h3>
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='20' y='20' width='60' height='60' fill='%23f39c12' rx='10'/><circle cx='35' cy='35' r='5' fill='%23fff'/><circle cx='65' cy='35' r='5' fill='%23fff'/><rect x='40' y='50' width='20' height='10' fill='%23e74c3c'/></svg>"
              alt="Ultimate Mecha"
              class="fighter-sprite"
            />
          </div>
          <div class="fighter-card">
            <h3>👑 Slime King 👑</h3>
            <img
              src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><ellipse cx='50' cy='65' rx='45' ry='30' fill='%23000'/><circle cx='35' cy='50' r='6' fill='%23ff0'/><circle cx='65' cy='50' r='6' fill='%23ff0'/><path d='M30 30 L50 20 L70 30 L60 40 L40 40 Z' fill='%23f1c40f'/></svg>"
              alt="Slime King"
              class="fighter-sprite"
            />
          </div>
        </div>

        <button class="btn btn-large" onclick="startFinalBoss()">
          ⚔️ Begin Final Battle
        </button>
      </div>

      <!-- Victory Screen -->
      <div id="victory-screen" class="screen">
        <h1>🎉 VICTORY! 🎉</h1>
        <p>
          Congratulations! You have successfully stopped the evil slimes and
          restored the asteroid mining colony!
        </p>
        <p>
          The colony is safe thanks to your brave mechas and strategic mining
          operations.
        </p>

        <div style="text-align: center; margin: 30px 0">
          <div style="font-size: 48px; margin: 20px 0">🏆🤖🏆</div>
          <h2>You are the champion of the asteroid!</h2>
        </div>

        <button class="btn btn-large" onclick="startGame()">
          🔄 Play Again
        </button>
      </div>
    </div>

    <!-- Load scripts in order - config first, then modules, then main app -->
    <script src="config.js"></script>
    <script src="start-screen.js"></script>
    <script src="map-screen.js"></script>
    <script src="mine-screen.js"></script>
    <script src="battle.js"></script>
    <script src="training.js"></script>
    <script src="app.js"></script>
  </body>
</html>
